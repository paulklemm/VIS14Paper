\documentclass[journal]{style/vgtc} 			          % final (journal style)
%\documentclass[review,journal]{style/vgtc}         % review (journal style)
%\documentclass[widereview]{style/vgtc}             % wide-spaced review
%\documentclass[preprint,journal]{style/vgtc}       % preprint (journal style)
%\documentclass[electronic,journal]{style/vgtc}     % electronic version, journal
%% Uncomment one of the lines above depending on where your paper is
%% in the conference process. ``review'' and ``widereview'' are for review
%% submission, ``preprint'' is for pre-publication, and the final version
%% doesn't use a specific qualifier. Further, ``electronic'' includes
%% hyperreferences for more convenient online viewing.
%% Please use one of the ``review'' options in combination with the
%% assigned online id (see below) ONLY if your paper uses a double blind
%% review process. Some conferences, like IEEE Vis and InfoVis, have NOT
%% in the past.

%% Please note that the use of figures other than the optional teaser is not permitted on the first page
%% of the journal version.  Figures should begin on the second page and be
%% in CMYK or Grey scale format, otherwise, colour shifting may occur
%% during the printing process.  Papers submitted with figures other than the optional teaser on the
%% first page will be refused.

%% These three lines bring in essential packages: ``mathptmx'' for Type 1
%% typefaces, ``graphicx'' for inclusion of EPS figures. and ``times''
%% for proper handling of the times font family.

\usepackage{mathptmx}
\usepackage{graphicx}
\usepackage{times}
% TODO: Self added Packages - need to be removed afterwards
%\usepackage{babel}
\usepackage[normalem]{ulem}
%\usepackage{color}
\usepackage{xcolor}
\newcommand{\rem}[1]{\textcolor{red}{\sout{#1}}}
\newcommand{\add}[1]{\textcolor{blue}{\uline{#1}}}
\newcommand{\com}[1]{\textcolor{orange}{\uline{#1}}}

%% We encourage the use of mathptmx for consistent usage of times font
%% throughout the proceedings. However, if you encounter conflicts
%% with other math-related packages, you may want to disable it.

%% This turns references into clickable hyperlinks.
\usepackage[bookmarks,backref=true,linkcolor=black]{hyperref} %,colorlinks
\hypersetup{
  pdfauthor = {},
  pdftitle = {},
  pdfsubject = {},
  pdfkeywords = {},
  colorlinks=true,
  linkcolor= black,
  citecolor= black,
  pageanchor=true,
  urlcolor = black,
  plainpages = false,
  linktocpage
}

%% If you are submitting a paper to a conference for review with a double
%% blind reviewing process, please replace the value ``0'' below with your
%% OnlineID. Otherwise, you may safely leave it at ``0''.
\onlineid{194}

%% declare the category of your paper, only shown in review mode
\vgtccategory{Research}

%% allow for this line if you want the electronic option to work properly
\vgtcinsertpkg

%% In preprint mode you may define your own headline.
%\preprinttext{To appear in an IEEE VGTC sponsored conference.}

%% Paper title.

\title{Interactive Visual Analysis of Image-Centric Cohort Study Data}

%% This is how authors are specified in the journal style

%% indicate IEEE Member or Student Member in form indicated below
\author{P. Klemm$^{1}$, S. Oeltze$^{1}$, K. Lawonn$^{1}$, K. Hegenscheid$^{2}$, H. V{\"o}lzke$^{2}$, B. Preim$^{1}$}
\authorfooter{
%% insert punctuation at end of each item
\item
 $^1$Otto-von-Guericke University Magdeburg, Germany.
\item
 $^2$Ernst-Moritz-Arndt-University Greifswald, Germany.
}

%other entries to be set up for journal
\shortauthortitle{Klemm \MakeLowercase{\textit{et al.}}: Interactive Visual Analysis of Image-Centric Cohort Study Data}
%\shortauthortitle{Firstauthor \MakeLowercase{\textit{et al.}}: Paper Title}

%% Abstract section.
\abstract{%
%(The problem).
\com{ToDo: Reviewer-Feedback: The abstract should be formulated more concisely and focus on What? 
Why? How? What follows?}
Epidemiological population studies impose information about a set of subjects (a \emph{cohort}) to characterize disease-specific risk factors.
%
Cohort studies comprise of heterogenous variables (\emph{features}) describing the medical condition as well as demographic and lifestyle factors and more recently, medical image data.
%
%The data are analyzed using a priori defined hypotheses to find statistically significant correlations between features (\emph{associations}).
%
%Modern cohort studies incorporate medical image data.
%
%
%The statistically driven epidemiological workflow only allows to determine \emph{associations} between image-derived metrics, such as distances extracted from landmarks of the segmentation model.
%\\\\
%(New Solution).
We propose an Interactive Visual Analysis (\emph{IVA}) approach that enables epidemiologists to examine both image-based as well as non-image data, e.g., sociodemographic features and attributes derived from the image data.
%
This is achieved by combining brushing and linking enabled coordinated information visualization views and interactive 3D shape renderings with epidemiological data representations such as pivot tables and key figures as association measures.
%(Validation).
The presented concepts are applied expert-guided to gather and evaluate hypotheses about the aging process of the lumbar spine.
%
%(Results). 
It allows a more flexible comparison between image and non-image data.
%
%(Implications).
The new framework enables hypotheses validation and generation by incorporating human pattern recognition as well as data mining methods.
%
Using all reliable information from the image segmentation linked to non-image features aims to unveil \emph{associations} by applying an iterative analysis approach.
} % end of abstract

%% Keywords that describe your work. Will show as 'Index Terms' in journal
%% please capitalize first letter and insert punctuation after last keyword
\keywords{Interactive Visual Analysis, Epidemiology, Spine}

%% ACM Computing Classification System (CCS). 
%% See <http://www.acm.org/class/1998/> for details.
%% The ``\CCScat'' command takes four arguments.

\CCScatlist{ % not used in journal version
 \CCScat{K.6.1}{Management of Computing and Information Systems}%
{Project and People Management}{Life Cycle};
 \CCScat{K.7.m}{The Computing Profession}{Miscellaneous}{Ethics}
}

%% Uncomment below to include a teaser figure.
  % \teaser{
  % \centering
  % \includegraphics[width=16cm]{CypressView}
  % \caption{In the Clouds: Vancouver from Cypress Mountain.}
  % }

%% Uncomment below to disable the manuscript note
%\renewcommand{\manuscriptnotetxt}{}

%% Copyright space is enabled by default as required by guidelines.
%% It is disabled by the 'review' option or via the following command:
% \nocopyrightspace

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%% START OF THE PAPER %%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{document}

%% The ``\maketitle'' command must be the first command after the
%% ``begin{document}'' command. It prepares and prints the title block.

%% the only exception to this rule is the \firstsection command
\firstsection{Introduction}

\maketitle

%% \section{Introduction} %for journal use above \firstsection{..} instead
Epidemiology aims at characterizing health and disease by determining risk factors.
%
Clinical problems, such as the selection of diagnostic tools and efficient treatment, are tackled using results of epidemiological research.
%
Also, the introduction of preventive measures in medicine and beyond is based on epidemiological research, where, for example, subgroups with increased risk are identified \cite{Fletcher2012}.
%
Observations made by clinicians in the daily routine are translated into hypotheses for epidemiological research.
%
These are used to determine environmental and lifestyle factors as well as medical examination results that may influence a disease.
%
Potentially useful data variables (\emph{features}) are gathered using structured interviews and clinical examinations.
%
Methods like regression analysis are employed to check the attribute list for statistical soundness.
%
\\\\
Longitudinal population-based studies, such as the Study of Health in Pomerania (SHIP) \cite{Volzke2011}, gather as much information as possible about a defined sample of people (a \emph{cohort}).
%
The cohort consists of several thousands of people who are randomly selected to avoid any bias.
%
\rem{Due to this random selection, the majority of the cohort does not suffer from a specific health problem.}
\add{The subjects are selected without focus on a certain disease.}
%
A large size of the cohort is therefore essential to investigate differences between healthy and diseased people.
%
% The sample is drawn randomized to avoid selection \cite{Fletcher2012}.
% %
% When for example one investigates risk factors for prostate cancer in male subjects, the outcome is strongly dependent on the age.
% %
% Therefore results need to be age-adjusted to be comparable.
% %
% Confounding variables, are often not obvious at all and characterizing them is already an epidemiological result.
%
Cohort studies often include medical image data.
%
Segmentation of these data would allow for anatomical structure analysis and enable correlation with other features.
%
Semi-automatic techniques are more promising but also challenging, since the employed modalities, such as magnetic resonance imaging (MRI) and ultrasound, are subject to inhomogeneity and noise.
%
Analyzing spatial data with respect to other epidemiological factors requires techniques that reach beyond standard statistical methods.

Compiling a list of features for tests of statistical resilience based on experience-driven hypotheses leaves out other features in the data which potentially interact with a disease.
%
This also applies to the chosen landmarks used to quantify medical image data information.
%
The standard workflow lacks methods, which identify correlations that the epidemiologists did not consider.
%
Also, only a small subset of variables can be concurrently analyzed, depending on the statistical measure.
\\\\
We propose an Interactive Visual Analysis (\emph{IVA}) approach \cite{Thomas2005} for the combined analysis of image and non-image data.
%
Visual queries and direct feedback of Visual Analytics systems allow for a fast exploration of the data space incorporating many different variables.
%
Intended as an extension to the well-established epidemiological tools it provides a way to rapidly validate hypotheses and to trigger \emph{hypothesis generation} using data mining methods, such as clustering.
%
\emph{Hypothesis generation} gains importance since the number of epidemiological features increases and the focus shifts towards more complex relations involving more than two features.
\\\\
Our contributions are:
\begin{itemize}
	\item an Interactive Visual Analysis workflow for cohort study data to allow both, hypothesis-driven analysis and hypothesis generation--based on a characterization of the standard epidemiological workflow,
	\item visualization techniques, which incorporate both information visualization and 3D rendering of organ shapes as well as combining them with epidemiological graphics and key figures,
	\item highlighting interesting subject groups and feature associations using shape-based clustering and statistical contingency measures,
%	\item an implementation of the presented methods in a web framework based on \texttt{WebGL}, \texttt{D3.js} and \texttt{NodeJS}.
\end{itemize}
%
\rem{The easy exchange of developed methods driven by modern web technologies intends to trigger a fast feedback loop between us and the epidemiologists}.
% http://wiki.infowiss.net/Gulf_of_execution ?
We applied our approach to a data set compiled to analyze diseases related to the lumbar spine and aim to determine features, which indicate pathological changes.
%
This data set comprises 127 features and 2 sequences of MRI data from 2,333 patients.
%
\add{We implement the presented methods using modern web technologies, such as \texttt{WebGL}, \texttt{D3.js} and \texttt{NodeJS}, making them easily accessible for the domain experts.
%
This aims to trigger a fast feedback loop between us and the epidemiologists.}

\section{Epidemiological Background} \label{MedicalAndTechnicalBackground}
% Wer ist an epidemiologischen Studien beteiligt?\\
% •  Ärzte (Facharzt für öffentliches Gesundheitswesen, Gene@ker)\\
% •  Medizinische Informa@ker mit Fokus auf Biometrie und Sta@s@k\\
% •  Bei klinischen Studien: Ärzte des entsprechenden Fachs

In this section we describe the epidemiological workflow and associated requirements.

\subsection{Epidemiological Workflow} \label{EpidemiologicalWorkflow}
\begin{figure}[htb]
 \centering
 \includegraphics[width=3.0in]{figures/workflow_comparison}
 \caption{\emph{IVA} tools complement parts of the epidemiological workflow instead of replacing them. The appropriate combination of statistical and interactive-driven analysis shows promising potential to unveil the information in the data. (a) shows the standard epidemiological workflow, (b) the \emph{IVA} supported one. The iterative red highlighted part is called the \emph{IVA Loop} and is described in more detail in Figure~\ref{fig:InteractionLoop}.}
  \label{fig:WorkflowComparison}
\end{figure}
The diversity of epidemiology is reflected in the different experts who work at cohort studies, ranging from specialized doctors to medical computer scientists with focus on biometrics, and statisticians.
%
Epidemiologists follow a workflow mainly driven by statistic tools to validate hypotheses about disease-specific risk factors.
%
Following Thew et al \cite{Thew2009}, the workflow can be characterized as follows:
%
\begin{enumerate}
	\item A hypothesis is derived from observations made by clinicians in their daily routine.
%
	\item A set of features depicting conditions affected by the hypothesis is compiled accordingly.
%
	\item Confounding features are identified and taken into account (for example using stratification).
%
	\item Statistical methods, such as regression analysis, assess the association of selected features with the investigated disease.
%
\end{enumerate}
The workflow is shown in Figure~\ref{fig:WorkflowComparison} (a) and serves as orientation for our approach although it does not consider any kind of image data.
%
We focus, on the potential of image data and attempt to support \emph{hypothesis generation}.

Reproducibility of results is an epidemiological key requirement.
%
It is difficult to achieve, since many physicians are involved when thousands of test persons are examined and interviewed.
%
Thus, both intra- and inter-observer variability needs to be low for all aspects of a cohort study examination.
%
Longitudinal studies require the acquired attributes to be comparable for evaluation.
%
If the data acquisition process changes, an information bias is introduced to the data, hampering inference in and between acquisition cycles.
%

In longitudinal cohort studies, grouping subjects using epidemiological features is essential in order to allow per-group risk determination.
%
Grouping depends on the underlying hypothesis.
%
Age for example is divided into groups (e.g. in 20 year steps) when investigating its influence on a condition.
%
These groups strongly depend on the condition of interest and therefore there is no standard on how to categorize them.

To determine whether a subject is prone to be affected by a certain disease, \emph{relative risks} are expressed through the evaluation of p-values, which indicate statistical significance.
%
Statistical correlations are prone to \emph{confounding}, meaning that the association of two features is influenced by a third feature, which needs to be isolated.
%
A famous example for a confounder is the association between shoe size and mortality, where it can be observed that people with larger shoe size have a smaller life expectation than people with small shoe size.
%
The shoe size is actually associated with gender, where women have smaller feet than men but also a longer life expectation.
%
\add{An extreme form of confounding is called \emph{Simpson's Paradox} \cite{SimpsonsParadox}, where the confounder reverses the observed effect between two features.
%
%An example is the higher mortality rate of non-insulin dependent diabetes opposed to insulin dependent diabetes.
A famous example is the Berkeley University gender bias case, where there were significantly less women admitted then man.
%
Analysis later showed that women applied mostly for strongly restricted subjects and when only looking acceptance divided by departments there was actually a small bias toward women.
%
%For example, insulin dependent and non-insulin dependent diabetes shows 
%In a famous example, researchers concluded that a newer treatment for kidney stones was more effective than traditional surgery, but it was later revealed that the newer treatment was more often being used on small kidney stones.
%For example, comparing mortality rate of non-insulin dependent 
%When for example surgeons are ranked regarding diseased patients, without including the risk of the surgeries, the results may be distorted.
}

Statistical tools such as \texttt{SPSS}\footnote{Product of IBM; \url{http://ibm.com/software/analytics/spss/}} play a major role for analyzing epidemiological data.
%
Graphic data representation is largely used to present results rather than gaining insight.
	
\section{Epidemiological Data} \label{EpidemiologicalData}
\com{Primary Reviewer Feedback: Another weakness is on the data analysis; while there is information about the data within the text (including 2.2, 4.1, and 5.2) I would like to see a section that focuses on the data and the challenges thereof.
This chapter needs to be enhanced! Maybe own section!}
Epidemiological data are highly heterogenous and incomplete.
%
Information about medical history and examinations, genetic conditions, geographical data, questionnaire results and image data yield a complex data space for each subject.
%
For ethical, legal or medical reasons some features cannot be gathered for each subject.
%
The most obvious example are women-specific questions about menstrual status or number of born children.
%
Follow-up examinations or questions about conditions like medications taken after a diagnosed disease also yield features only available for a small amount of subjects.
%

Indicators for medical conditions as well as questions about a subject's lifestyle are \rem{also} often \emph{dichotomous}--they have two manifestations (\emph{Yes} or \emph{No}).
%
Dichotomous data can also be derived by aggregating features to yield only two manifestations (e.g. subjects younger or older than 50 years).
%
Medical examinations mostly comprise categorical (e.g. levels of back pain) and continuous values (e.g. age or body size).

\subsection{Image acquisition} \label{ImageAcquisition} Imaging techniques involving ionizing radiation for the subject are not suitable for ethical reasons.
%
Therefore, MRI is the main method for collecting cohort study imaging data.
%
The image quality is a tradeoff between accuracy and affordability \cite{Preim2014}.
%
This often yields image resolutions inferior to those of clinical day-to-day practice, which makes their analysis more challenging.
%
%The equipment used to gather medical image data is not updated or changed during a longitudinal study to ensure comparability in and between acquisition cycles.
The equipment used to gather medical image data is \rem{kept, if possible, on the initial software and hardware version} \add{not updated or changed} during a longitudinal study to ensure comparability in and between acquisition cycles.

\subsection{Image analysis} \label{ImageAnalysis} Decisions have to be made on how image data are \emph{compared} and \emph{quantified}.
%
Segmentation masks representing the voxels of an anatomical structure would be ideal, since many different key figures, e.g., volume, largest diameter or aspect ratio, can be derived from them.
%
Since reliable and efficient segmentation techniques for these data are not available in general, epidemiologists are forced to measure the data by hand, which is a very tedious work with respect to the number of necessary landmarks and the number of subjects.
%
Information derived by landmarks, such as top and bottom point of a vertebra, are by far not as expressive and versatile as segmentation masks describing its whole shape.
%
They are also prone to a high inter-observer variability and are hard to reproduce.
%
This gains even more importance when analyzing multiple time steps.
%
Morphometric information from landmarks comprises thickness, diameter or length of a structure as well as grey value distribution in an area (used for determining the type of tissue).

% Bernhard Paper\\
% - sociodemographic data\\
% - medical data\\
% - pain indicators\\
% - DATA TYPES\\
% 	- dichotomous data\\
% \\
% - Missing Data\\
% - Follow-Up Questions?\\
% - grouping essential\\
% - problems when analyzing image data\\
% 	- what are Problems there\\
% 	- how can shape be included?\\
% 	- show image data of multiple subjects


\subsection{The Study of Health in Pomerania (SHIP)}
After the pioneering Rotterdam study (started in 1990), several MR imaging study initiatives have evolved.
%
They slightly differ in clinical focus, acquired data and epidemiological research questions.
%
Starting in 1997 with a cohort consisting of 4,308 subjects, the \texttt{SHIP}, located in Northern Germany, aims to characterize health and disease in the widest range possible \cite{Volzke2011}.
%
Data is collected without focus on a group of diseases.
%
This allows the data set to be queried regarding many different diseases and conditions.
%
Subjects were examined in a 5-year time span, continuously adding new parameters including MRI scans in the last iteration \cite{Hegenscheid2009}.
%
The MRI protocol features a rich number of sequences.
%
A second cohort \texttt{SHIP-Trend} was established in 2008.
%
The protocols for examining the subjects between \texttt{SHIP} and \texttt{SHIP-Trend} remained the same, making them comparable.
%
The overall examination time for each person attending the study is two days.

\section{Prior and Related Work}
Designing a visualization, which conveys all data aspects equally, is challenging.
%
Given the number of features of epidemiological data sets and their different manifestations, the strength of different visualization techniques needs to be combined \cite{Buja91, Konyha2009}.
%
The principal component analysis (PCA) and similar techniques are able to reduce the dimensions by extracting most expressive components, but make the influence of each variable hard to convey.
\\\\
%Their focus on \emph{hypothesis generation} using parallel assessment of multiple data features makes the work of Turkay and colleagues closest to ours albeit our emphasis on processing models derived from medical image data segmentation and variables with categorical manifestations \cite{Turkay2013}.
\rem{Their} \add{Turkay and colleagues \cite{Turkay2013}} focus on \emph{hypothesis generation} using parallel assessment of multiple data features makes \rem{the work of Turkay and colleagues} \add{their work} closest to ours albeit our emphasis on processing models derived from medical image data segmentation and variables with categorical manifestations \rem{\cite{Turkay2013}}.
%
Their methods aim to amplify a hypothesis generation process for analyzing data of a Norwegian aging study.
%
Statistical measures of continuous variables, such as mean, standard deviation, skewness, or inter-quartile range, are used to create \emph{dimension plots} that make them comparable with respect to the derived descriptive measures, such as voxel number of a segmented structure.
%
%These transform dimensions into data points and make them comparable with respect to the derived descriptive measures, making them comparable.
%
%This not only allows for comparing all continuous variables in a single plot but make their distribution change comprehensible.
%
%This requires a good descriptive measure which captures the kind of change the user is interested in or which reflects unexpected data behavior.
%
%The technique was applied to features obtained by segmenting the brain into 45 parts and measure the voxel number, volume and properties of the intensity values.
%
The method is strongly dependent on the descriptive measures of the epidemiological factors.

%\emph{Over-fitting} of hypotheses to the data may be imposed  is a danger pointed out by the authors when hypotheses to the data based on observations of changes in these plots the measure highlights only subsets of statistical changes.
Hypotheses based on observations of changes in these plots may impose \emph{overfitting} to the data because the measures highlight only subsets of statistical changes.
%
Our approach sticks more to the information extracted from the segmented image data and variable associations with non-image epidemiological factors.
% Disadvantage - Nur 2 abgeleitete Variablen sichtbar, schlecht mit anderen Variablen in Verbindung zu bekommen (müsste jedoch auch gehen) - viele Dinge gehen durch die Abstraktion aber auch flöten!

\paragraph{Visualizing Image and Non-Image Data. }
Gresh \rem{and colleagues} \add{et al. \cite{Gresh2000}} proposed \texttt{WEAVE}, one of the first systems which concurrently analyzed medical image and non-image data using linked views.
%
Blaas \rem{and colleagues} \add{et al. \cite{Blaas2007}} presented a similar system which analyzed medical image data and variables derived from them using views from the feature and physical space.
%
They incorporated data mining methods such as dividing the data space by using a k-nearest neighbor technique and the PCA.
%
Steenwijk \rem{and colleagues} \add{et al. \cite{Steenwijk2010}} employ a relational database to organize the data for visualizing subject data using linked views such as parallel coordinates, scatterplots and time plots.
%
Zhang \rem{and colleagues} \add{et al. \cite{Zhang2012}} provide a web-based system for analyzing subject groups with linked views and batch-processing capabilities for categorizing new subject entries into the data set.
%
Their understanding of a cohort differs from the understanding of the term in an epidemiological context by denoting every parameter-divided subject group as individual cohort.

\paragraph{Visualizing Heterogenous Non-Image Data.}
Generalized Pairs Plots (\texttt{GPLOM´S}) are an information visualization technique comparing heterogenous variables pairwise using a plot-matrix grouped by type \cite{Francois2013}.
%
They are useful to gain an overview over numerous variables and their distributions.
%
Histograms, bar charts, scatterplots and heat maps are used to visualize variable combinations with regard to their type.
%
%Brushing, linking and filtering are feasible with \texttt{GPLOMS}, but have limitations such as making only one category brushable at a time.
%
%We applied this technique to our data and it shows promising potential for simultaneously visualizing many different variables. %but does not fit in the scope of this paper.
%
%The inspiration on the chosen visualization techniques stems from this publication.
%
Dai \rem{and colleagues} \add{et al. \cite{Dai2005}} explored risk factors by incorporating choropleth maps of epidemiological features (e.g., mortality rates in a region) with parallel coordinates, bar charts and scatterplots with integrated regression lines.
%
Their findings yielded a \emph{Concept Map}, which linked cancer-related associations via graph edges.
%
Chui \rem{and colleagues} \add{et al. \cite{Chui2011}} visualized associations in time-dependent epidemiological data using time-series plots highlighting risk factor differences in age and gender.

\paragraph{Commercial Data Visualization.}
Commercial systems such as \texttt{Tableau}\footnote{Owned by Tableau Software; \url{http://tableausoftware.com}} or \texttt{Spotfire}\footnote{Owned by TIBCO; \url{http://spotfire.tibco.com}} provide a rich user interface that enables a Visual Analytics approach without the need of writing any code.
%
With little effort, linked views can be created, but the data processing possibilities such as derivation of new variables or the 3D rendering capabilities are very limited.
%
These systems with their origin in business intelligence applications do not support epidemiological workflows, in particular workflows that also consider medical image data.
% Image Data
% \paragraph{Visualizing Image Data.}
\paragraph{Visualizing Shape Variance.}
Comparing tissue between many subjects requires methods which allow for shape variance visualizations.
%
Caban \rem{and colleagues} \add{et al. \cite{Caban2011}} investigated the suitability of variance visualizations of shape distribution models and concluded that users favor spherical glyph representations over deformation grids and likelihood volumes.
%
The distribution of shapes in a space derived from a PCA is plotted by Busking \rem{and colleagues} \add{et al. \cite{Busking2010a}} in a 2D-projected plane of the space.
%
Interpolated views can be created by the user in a separate view as well as comparisons in a contour view.
%
Interpolation is carried out by mesh morphing.
%
The distance to the mean shape is color-coded.
%Differences between structures are highlighted using color mapping of the difference to the mean shape, but is rather hard to recognize due to small renderings of each subject in the shape-space.
%Via mesh morphing interpolated views can be created by the user in a separate view as well as comparisons in a contour view.
%
We incorporate the idea of combining 3D shape rendering with information visualization techniques.
%
%Applying our data sets to this technique yielded a cluttered shape space due to the many subjects.
%
%The data needs to abstracted or summarized in order to work in this context.
%
Hermann \rem{and colleagues} \add{et al. \cite{Hermann2014}} identify local deformation changes by investigating shape-related differences on rodent mandibles.
%
User specified regions of interests are mapped to associated anatomic covariation using tensor visualization.
%Anatomic covariation induced by user input is displayed using tensors 
%Specifying a change in shape of a certain area by the user shows how other parts of the model would react using covariance tensors.
%Covariance tensors indicate how a model is deformed when the user given a user specified deformation.
%The user specifies a deformation of interest and showing corresponding changes in the shape using covariance tensors.
%
This method allowed for rapid hypotheses validation and was able to reproduce textbook knowledge.
%
%By plotting p-values in ventricle surfaces, Chou and colleagues were able to map disease-associated values directly on a 3D tissue representations \cite{Chou2009}.
%
%This requires a geographic colocation of associated features.
%

% *********************** Our own Work ***********************
% Prior Work
\paragraph{SHIP Data Analysis.}
Klemm et al. \cite{Klemm2013VMV} visualized lumbar spine variabilities based on an semi-automatic shape detection algorithm of 490 participants of the \texttt{SHIP-2} cohort.
%
Hierarchical agglomerative clustering divided the population into shape-related groups.
%
As proof of concept, a relation between the size of the segmented shape and measured size of the subjects was shown.
%
This work focuses on incorporating these derived data as new features of the overall data set, making it possible to include it into the hypothesis validation and generation process.
%
When applying clustering techniques on the non-image data it was found that \texttt{k-Prototypes} and \texttt{DBSCAN} is appropriate in the epidemiological context, but is strongly dependent on the chosen variables and distance measure \cite{Klemm2014BVM}.
%
Niemann et al. \cite{Niemann2014} presented an interactive data mining tool for the assessment of risk factors on hepatic steatosis, the fatty liver disease.
%
Association rules created by data mining methods can be analyzed interactively with their presented tool and highlight potentially overlooked features.
% *********************** / Our own Work ***********************

\paragraph{Interactive Visual Analysis}
% Interactive Visual Analysis - Steffens Paper
The strength of the \emph{IVA} approach described in the next section is its versatility with respect to the application field \cite{Konyha2009}.
%
Oeltze et al. \cite{Oeltze2007} combined a linked view representation of results from a statistical analysis with feature localizations of the tissue perfusion with the goal of its evaluation.
%
This was focused on individual patients and not on cohort study data. 
%

%While we take similar steps when analyzing the data such as employing statistical tests, our data is mostly independent from the medical image data and is not describing it. %--except the variables derived the segmentation model itself.
While we take similar steps when analyzing the data, such as employing statistical tests, our data are not associated in a geographical or temporal context, which affects the techniques described in the following section.

%\section{Interactive Visual Analyis in Cohort Study Data}
\section{Image Centric Cohort Study Data in Interactive Visual Analysis Context} \label{Image Centric Cohort Study Data in Interactive Visual Analysis Context}
We described the epidemiological workflow as a sequence of steps taken by domain experts which need to comprise reproducibility and statistical integrity (recall Subsection~\ref{EpidemiologicalWorkflow}).
%
Figure~\ref{fig:WorkflowComparison} (a) shows this workflow as a consecutive series of steps.
%
Introducing the \emph{IVA} principle to the epidemiological application domain aims to compensate its weaknesses rather than replacing the existing workflow.
%
In the current state, the workflow treats the data like a black box.
%
Statistical tests on features associated to a hypothesis yield a value for deciding whether the data supports the hypothesis or not.
%
Features not included in the analysis may potentially support the chosen hypothesis by discriminating the population in the expected way, but are not highlighted in any way.
%
This becomes even more important when the workflow is adapted to the analysis of the medical image data, where
domain experts annotate landmarks tediously to derive metrics, such as diameters.
%
This leaves out the majority of information in the image data by abstracting it to single values.
%
It is easily possible that left out information would heavily influence the result.
%
Considering more complex parts of the data would make those results more trustworthy and also could identify possible anatomical confounders--an epidemiolgical research result in itself.
\\\\
\emph{IVA} tries to illuminate the black box by making the domain experts part of an iterative feature selection process, which is shown in Figure~\ref{fig:WorkflowComparison} (b) as part of the epidemiological workflow.
%
It also aims to project back into the hypothesis formulation step to amplify hypothesis generation.
%
This has to be handled with care, since \emph{overfitting} of expectations to the data is an imminent danger \cite{Turkay2013}.

\paragraph{Domain and Range Variables. }
In the \emph{IVA} context, data are characterized by a combination of independent variables, such as space and/or time, and dependent variables, like temperature or pressure.
%
Two kinds of views are employed to inspect the data:
\begin{itemize} 
	\item \emph{physical views} \cite{Oeltze2013}, such as direct volume rendering, show information in the context of the spatiotemporal observation space \cite{Oeltze2007}, while
	\item \emph{attribute views}, such as scatter plots and parallel coordinates, show relationships between multiple data attributes.
\end{itemize}
Transferred to epidemiological data, the residential area of cohort subjects could be interpreted as space, the different assessment cycles of a longitudinal study as time, and the image and non-image data as dependent variables.
%
However, our current work neglects geographical and temporal aspects.
%
Instead we employ a more abstract model and consider the subjects as living in a joint image space where each of them is represented by a particular segmented organ or structure.
%
For instance, the lumbar spine is segmented over all subjects and all lumbar spines are co-registered spanning a joint space.
%
Then, two types of dependent variables exist: 
\begin{enumerate}
	\item the socio-demographic data and medical examination results and 
	\item variables derived from the segmented structures, e.g., spinal curvature or misalignment of the vertebrae.
\end{enumerate}
An alternative of the image space would be the shape space generated by extracting the major modes of variation from all segmentation results \cite{Busking2010a}.
%
Based on our abstract model, the three analysis patterns of \emph{IVA} can be employed.

\paragraph{Local Investigation:} refers to the inspection of dependent variables with respect to certain subsets of the image or shape space.
%
For instance, the epidemiologist selects several lumbar spines with a common characteristic in the image or shape space and wishes to inspect the associated dependent variables in an attribute view \cite{Hermann2014}.
%
The selection step requires dedicated interaction techniques for defining a subset.
%
Alternatively, derived shape-related variables opposed in an attribute view or automatic techniques for shape clustering may be employed \cite{Klemm2013VMV}.
%
Clustering algorithms can be used to investigate associations between shape groups and other non-image-based variables.
%
Analysis of outliers can indicate segmentation errors or a group of subjects sharing a pathology.

\paragraph{Feature Localization:} refers to the search for structures in the image or shape space with a defined characteristic.
%
The epidemiologist may be interested in all female subjects with lower back pain and wishes to see the corresponding spines in a physical 3D view.

\paragraph{Multivariate Analysis:} refers to an investigation of multi-variate properties of the dependent data by specifying a feature in one attribute view and at the same time analyzing the value distribution with respect to other variables in other attribute views.
%
Epidemiologists may define a feature in a scatter plot of the body mass index (BMI) and age to inspect the result in a histogram of body height.
%
These associations may also be summarized using pivot tables which are popular in epidemiology.

\subsection{Data Preprocessing} \label{Data Preprocessing}
Transformation operations on the data to prepare it for an \emph{IVA} system are denoted as data preprocessing.
\paragraph{Non-Image Data. }
%
Multimodal features require different techniques.
%
Data obtained using questionnaires or medical tests are often stored using statistical packages such as \texttt{SPSS}, which have a proprietary data format with limited export capabilities.
%
Exporting the data in the respective tool to a CSV file and then converting it to file types that are easily manageable, such as JSON or XML, makes it readable for all modern programming languages.
%
This can be achieved by using data wrangling tools such as \texttt{OpenRefine}\footnote{Developed by Google, Open Source; \url{http://openrefine.org}}, which also validate the data (find missing data, clean up bad formatting, transform scales).
%
%Including the data dictionary, which stores information about each manifestation of a feature, helps to get a detailed description of data variables and the meaning and unit of measurement of their values.
%A data dictionary stores information about each manifestation of a feature and is stored as lookup table to get a detailed description of data variables and the meaning and unit of measurement of their values
A data dictionary stores information about each manifestation of a feature.
%
Detailed description of data variables, its meaning as well as unit of measurement are stored as a lookup table.
%Exporting the data dictionary, which stores information about each manifestation of a feature, is also an important step to get a detailed description of data variables and the meaning and unit of measurement of their values.
%
Missing data are denoted using error codes indicating their cause ranging from ethical to medical and personal issues (recall Subsection~\ref{EpidemiologicalData}).
%The reasons for missing data have a wide range from ethical to medical and personal issues.
%
%Therefore, these are also included as error codes which have to be marked as such in the data dictionary.
\paragraph{Image Data. }
Information about anatomical structure, such as diameter or volumes, is extracted from the image data.
%
This is either done manually by experts setting landmarks (sometimes supported by algorithms connecting the landmarks such as graph cuts \cite{GraphCut}) or by a (semi-)automatic detection, registration and segmentation.
%
These algorithms have to deal with a large inter-subject variability of the anatomical structure and need to create reproducible results \cite{Preim2014}.
%
In principle, model-based approaches have shown to be effective for detection \cite{Rak2013} and segmentation \cite{Gloger2010, Gloger2012}.
%
If a segmentation yields only binary masks separating the structures, algorithms such as \emph{Growing and Adaptive Shapes} can be applied creating a surface grid where each point is comparable throughout the population \cite{Ferrarini2007}.
%
Grey value comparison is usually used to measure the quantity of fat, water, and--application-specific--the iron content (liver) or the distribution of grey and white brain tissue.

Morphometric features are derived to allow for statistical comparison of the tissue, which incorporates mostly positions, diameters, volumes and relative distances and alignment to other structures.
% 
% - Data Format\\
% - Missing Data\\
% - Registration of Image Data (VMV'12)\\
% - Extraction of Image Parameter
\subsection{Analysis Workflow}
\begin{figure}[htb]
 \centering
 \includegraphics[width=3.0in]{figures/InteractionLoop}
 \caption{Detailed \emph{IVA Loop} as extension from Figure~\ref{fig:WorkflowComparison}.
 %
 Usually starting with a selection of a feature of interest (user-driven or via data mining techniques), the data are mapped using a visualization technique appropriate for the selected data types.
 %
 The data are visualized in the range and domain space, which can then be brushed, yielding new groups, to be investigated using further features.
 %
 Note that adjacent steps are directly connected via feedback loops allowing for an iterative refinement and giving as much freedom to the user as possible.}
 \label{fig:InteractionLoop}
\end{figure}
%-------------------------------- Figure --------------------------------
\begin{figure*}[htb]
 \centering
 %\includegraphics[width=1.5in]{figures/InteractionLoop}
 % \includegraphics[width=3.5in]{figures/visualization}
 %\includegraphics[width=1\textwidth]{figures/visualization}
 \includegraphics[width=1\textwidth, resolution=300]{figures/visualization}
 \caption{(Left) Screenshot from the front-end, which is divided as follows: (a) The sidebar containing all features as well as the groups defined in the analysis process; (b) the canvas area where features can be added via drag and drop and the visualization can be chosen automatically according to the data type; (c) the interactive pivot table showing the exact numbers for each displayed feature combination. The data displayed is used to analyze the lumbar spine. Features can be added freely on the canvas via drag and drop. Dropping the \emph{gender} parameter on the already plotted \emph{body size} container creates a mosaic plot combining both features (right).
 }
 \label{fig:visualization}
\end{figure*}
%-------------------------------- /Figure -------------------------------
Our proposed \emph{IVA} workflow knows three major steps as illustrated in Figure~\ref{fig:InteractionLoop}: Feature selection, visualization and brushing.
%
A hypothesis-driven analysis usually starts with the selection of features.
%
A feature selection from a shape-based clustering, which creates shape groups.
%
\emph{Hypothesis generation} with focus on image data starts with a shape-based clustering.
%
\com{Multivariate analysis using the adjacency matrix may have also be explained here, depending on the Application chapter.}
%
The feature is mapped using an automatically chosen visualization appropriate for its data type (described in detail in the following section).
%
The visualization techniques have to combine both image-and non-image data in order to set domain and range data in relation to each other.
%
In our system, the visualization can either be brushed or new features can be added to the analysis. 
%
Brushing methods are subdivided using the previously described \emph{IVA} patterns.
%
Brushed regions are treated like features as they divide the subject space just like categorical features.
%
Selecting features also triggers a \emph{multivariate analysis} using contingency values (described in the following section) to highlight features associated with selected features.
%
A sample workflow using interaction and visualization techniques described in the next section can be seen in Figure~\ref{fig:visualization}.

\subsection{Interaction and Visualization Techniques} \label{Interaction- and Visualization Techniques}
%
The suitability of an interaction and visualization technique for epidemiological data depends on its ability to intuitively compare multiple data features at once while highlighting new associations.
%
The methods have to use domain language and reflect \add{the} routines \rem{of}\add{that} epidemiologists \add{take} in order to be incorporated into their research.
%
Visual evaluations of data are therefore as important as methods allowing for numerical data analysis.
%
In the following sections we present the different parts of our proposed \emph{IVA} system for image-based cohort study analysis.

\begin{figure}[htb]
 \centering
 \includegraphics[width=3.5in]{figures/similarity_matrix}
 \caption{Adjacency matrix of 129 features (127 data set variables, 2 cluster results) with a grand total of 16,641 combinations.
 %
 Similarity is calculated using the \emph{Cram\'{e}r's V} contingency value.
 %
 Color brightness encodes association strength.
 %Mouse-over focuses a entry and highlights the feature names for better readability.
 Mouse-over an entry highlights the feature names for better readability.
 %
 The enlarged excerpt shows associations for shape clusters of subjects with and without diagnosed spine attrition, which show associations between gender, weight, body height and smoking behavior.
 }
 \label{fig:similarity}
\end{figure}

\section{System Structure and Design} \label{Structure and Workflow}
\com{Primary Reviewer Feedback: There is little detail about the design, and how it was decided to create this particular design; what interaction was made with the users, how did they influence this design?}
% \subsubsection{System Structure}
We divide the workspace into four major parts, as illustrated in Figure~\ref{fig:visualization} and \ref{fig:similarity}.
\begin{itemize}
	\item The \emph{sidebar}, which contains all epidemiological features. Cluster results are treated like features and are part of the sidebar as well.
	\item The \emph{canvas} holding all visualizations. Elements can be added, arranged, resized and removed freely.
	\item The interactive \emph{pivot table} gives detailed numerical information of the features in the canvas view. This view on the data comes natural to epidemiologists.
	\item The \emph{contingency view} depicts relations for features in the canvas in an adjacency matrix.
\end{itemize}
%
% The sidebar holds all available variables as well as groups either derived by user input or automatic clustering.
% 
% Features can be dragged from the sidebar into the canvas area.
% %
% Doing so will automatically create an information visualization suitable for the current data type.
% %
% 3D shape information about the investigated structure is displayed for each variable manifestation.
% %
% By dropping variables on existing visualizations the system creates a visualization that allows for comparison (e.g. mosaic plots for ordinal variables).
% %
% Elements can be brushed in the information visualizations and are linked to the other representations in the canvas.
% %
% Shape-based clustering can either be applied to all subjects or subgroups.
% 
% All elements in the canvas view are also represented in the interactive Pivot Table which gives detailed information how the subjects are distributed given the displayed variables.
% %
% Details to the different views are presented in the following sub-sections.

\paragraph{Sidebar.}
An overview of all features is presented in a sidebar where they are categorized into different types, such as somatometric (measurements of the dimensions of the human body), disease- or lifestyle-related, pain indicators and laboratory data.
%
It also contains subject groups either defined by brushing or automated shape clustering.
%
Groups are treated like features since they act the same by dividing the subject space into labeled categories.
%
Variables can be dragged from the sidebar into the canvas area for a \emph{feature localization} which works as follows.
%
%This triggers an adaptive feature visualization suitable for the current data type.
%Bar charts show the distribution of manifestations of each variable in the sidebar.

\paragraph{Adaptive Feature Visualization.} \label{sec:AdaptiveFeatureVisualization}
The visualization type is, inspired by \texttt{GPLOMS} \cite{Francois2013}, dynamically chosen based on the feature types and number.
%
Categorical data are either mapped using bar charts (single features) or mosaic plots (multiple features).
%
Figure \ref{fig:visualization} describes this dynamic adjustment.
%
Continuous data can be visualized using scatterplots (single features) or parallel coordinates (multiple features), but in epidemiology, this data type is usually categorized into ordinal groups of \emph{equal size}.
%
Since the number of categories often depends on the hypothesis, the discretization steps can be adapted dynamically.
%
Too many groups potentially generate sparse bins not suited for statistical evaluation. 
%
Not enough groups overgeneralize information.
%
Adaptive discretization is an option, but imposes overfitting to the data.
%
Drawn conclusions based on statistical relationships derived from groups already biased by feature distribution are heavily influenced by the used discretization.
%
Therefore we follow the convention to use bins of equal size. 

%
% TODO Implement MOSAIC PLOTS, Scatterplots, Parallel Coordinates
Following Tufte's concept of \emph{small multiples} \cite{Tufte1983}, \add{information derived from the} medical image data are directly incorporated into the plot by including color-coded mean shapes for each manifestation (Figure~\ref{fig:visualization} (b)).
%
The 3D plots can be navigated using standard mouse inputs, the camera is synchronized between all views to enable direct comparison.
%
Mapping the distance from a group mean shape to the global mean using color allows to assess local shape changes.
%%TODO Adaptive visualization!
If a feature is dropped on an existing plot, the visualization changes dynamically to properly make them comparable (Figure~\ref{fig:visualization} (right)).
%
Each plot can be brushed using widgets.
%
Brush selections are propagated to all visualizations allowing for fast feature querying.
% TODO Timeline
%
%It is possible to duplicate brushes in order to create new groups which are evenly spread out.
%
%A use case for this is when a continuous feature has to be divided into even groups.

\paragraph{Pivot Tables.}
Pivot tables are frequently used to present the data in epidemiological publications.
%
Epidemiologists are used to process groups based on table representations.
%
Thus, we decided to introduce an interactive pivot table.
%
These tables clearly convey the subject count in each group (see Figure~\ref{fig:visualization} (c)).
%
However, they quickly get confusing and cluttered when they are divided into many subgroups.
%
We tackled this problem by making the order and number of displayed variables adaptable.
%
This also applies to the assignment of row or column variables.
%
Another way to avoid clutter is the user-driven selection of displayed variables.
%
To allow better comparison with respect to features, the values of each cell can also be displayed as percentage of the feature represented of either the row or column.
% TODO IMPLEMENT

\paragraph{Automated Feature Suggestion using a Contingency Matrix.}
As previously discussed, highlighting potentially interesting values in the data set is one major benefit of the \emph{IVA}-powered approach and belongs to the \emph{multivariate analysis} pattern,  analyzing features outside the shape space.
%
Turkay et al. \cite{Turkay2013} used the approach to calculate various key figures based on the distribution functions of each feature derived from the image data.
%
Since the majority of our data are categorical features, we have to employ different solutions.
%
The \emph{Cram\'{e}r's V} contingency coefficient can be used to calculate coherences between categorical variables \cite{CramerV}.
%
It is based on \emph{Pearson's $X^2$} distribution test \cite{ChiSquare}, which uses contingency tables holding the counts of subjects for all possible manifestations of two variables.
%
\emph{Cram\'{e}r's V} is defined as:
\begin{equation}
V = \sqrt{\frac{X^2}{N(k-1)}},
\end{equation}
where $X^2$ equals \emph{Pearson's chi squared}, $N$ is the total number of observations and $k$ is either the row or column count, depending on which one is lower.
%
$V$ assumes values between $0$, meaning that two variables are completely independent, and $1$ indicating they are the same.
%
\emph{Cram\'{e}r's V} is always positive and does therefore not allow statements about dependency direction.

It shares the same restrictions as \emph{Pearson's $X^2$}.
%
The expected counts in the contingency table have to be larger than 5 for $80\%$ of the entries and no expected value must be smaller than one \cite{Cochran1952}.
%
Some manifestations and feature combinations, which are only exposed by small subject groups, cannot be assessed with this technique.
%
They cannot be included into the epidemiological analysis, since statistical validation needs a minimum count to be seen as valid.
%
The contingency matrix highlights correlations between all data set features. %of visualized features with features in the data set.
%
This aims to highlight features possibly associated with the focused hypothesis as well as trigger generation of new hypotheses.
%
Contingency is visualized using an interactive adjacency matrix with association power mapped to color brightness.
%
The distinction whether an association is a confounder or an effect, depends on the context defined by the hypothesis and is a decision to be made by the domain expert.
% \subsubsection{Automated Feature Suggestion}
% % https://de.wikipedia.org/wiki/Kontingenzkoeffizient#Cram.C3.A9rs_V
% 
% As discussed previously, highlighting potential interesting values in the data set is one major benefit of the \emph{IVA} powered approach.
% %
% Turkay and colleagues used the approach to calculate various key figures based in the distribution functions of each feature derived from the image data \cite{Turkay2013}.
% %
% Since the majority of our data are categorical features, we have to employ different solutions.
% %
% A solution for this problem are odds ratios, which are a standard statistical tool for stating relations between features.
% %
% Odds ratios can only be calculated for $2\times2$ contingency tables which usually represent the presence of a condition in a population divided by a characteristic (e.g. male/female subjects with presence or absence of back pain).
% %
% To calculate odds ratios for variables with more than two manifestations, we calculate local odds ratios for each possible combination, yielding a matrix for each feature combination \cite{Rudas1998}.
% %
% When the subjects are divided into groups and the calculation is carried out again for all feature combination, the difference in sum of the odds weighted with the number of manifestations per feature can be used to indicate if the feature combination yields a difference.
% %
% These differences are then highlighted in a separate tab of the side bar "Interactions".
% %
% Interestinassociationons then can be assessed creating a linked view using the standard drag and drop workflow.
% \\\\
% In the following sections we will discuss details of the implementation which relies on modern Web-Technologies.
% \\\\
% ToDo\\
% - This can be improved--summing up the values possibly not the cleverest solution--calculation of variance etc. possible\\
% - Matrix Visualization?

\subsection{Implementation}
\begin{figure}[htb]
 \centering
 \label{fig:technologies}
 %\includegraphics[width=1.5in]{figures/InteractionLoop}
 \includegraphics[width=3.5in]{figures/technologies}
 \caption{The front-end solution (left) uses state-of-the-art web technologies such as \emph{HTML5}/\emph{CSS3}, \emph{WebGL} and \emph{SVG} to display the data.
 % 
 The \emph{NodeJS} based back-end (right) stores all image and non-image data and transfers it to connected clients.
 %
 All computation-heavy operations, such as calculation of mean shapes or distances, as well as statistical processing are done by the server to keep hardware requirements of client systems low. 
 %
 Client-server communication is accomplished via the \emph{Websocket} protocol.
 }
\end{figure}
In this section we discuss how we implemented the presented methods using free, open web standards.
%
To provide a fast communication loop between method development and expert input, we decided to rely on modern web technologies.
%
In addition to the obvious advantages of web technologies, the following aspects are crucial for our work:
\begin{itemize}
%	\item No additional software needs to be installed, most people use a decent state-of-the-art web browser, even on mobile devices.
	\item The client-server structure allows for employing heavy computation on a capable server machine and transfering results to the client.
	\item Since image data for several thousand subjects requires hundreds of gigabytes disk space, it can remain safely on the server and elements can be transferred on demand.
	%
	High confidentiality standards of the data can be met by restricting access via an account system.
	\item Recent developments in \emph{WebGL} applications running in browsers with near-native performance push the development further into to the web resulting in many open source libraries, which are well documented, rich in examples and driven by active communities. We use \emph{WebGL} for rendering shape information.
%	\item Web technologies are free.
\end{itemize}
These advantages do not come without drawbacks.
%
Due to missing ports of sophisticated and specialized libraries/languages, such as the \texttt{Visualization Toolkit} (\texttt{VTK})\footnote{Developed by Kitware Inc; \url{http://vtk.org}} or \texttt{R}\footnote{Open Source; \url{http://r-project.org}} for statistics, many standard methods need to be written from scratch for the web.
%

The back-end is written using \texttt{NodeJS}\footnote{Developed by Joyent Inc, \url{http://nodejs.org}}, which is based on the Google V8 Javascript runtime environment.
%
Due to its event-driven non-blocking I/O model it is fast and does not freeze in case of heavy workload like mesh calculation.
\\\\
Non-image data for all subjects including the data dictionary is stored in a JSON file on the server.
%
Image data are available as raw DICOM files as well as meshes representing segmentation masks of anatomical structures, which can be used to compare subjects.
%
The requested data is transmitted when a client connects.
%
The server performs heavy statistical tasks, such as calculation of \emph{Cram\'{e}r's V} values for all feature combinations in order to keep the computation time on the client as low as possible.
%

The front-end is created using \texttt{Bootstrap}\footnote{Developed by Twitter, \url{http://getbootstrap.com}} as foundation for the layout and basic UI elements using \texttt{HTML5}, \texttt{CSS3} and \texttt{Javascript}.
%
Information visualizations such as scatterplots and bar charts are created using the popular \texttt{Data-Driven Documents (D3.js)} library \cite{D3}, which works well for attaching data to visible elements like vector graphics and provides powerful transformation and mapping tools.
%
The pivot table implementation was adapted using \texttt{PivotTable.js}\footnote{Developed by Nicolas Kruchten, \url{http://nicolas.kruchten.com/pivottable}}.
%
\texttt{Three.js}\footnote{Originally developed by Ricardo Cabello, \url{http://threejs.org}} allows GPU-accelerated data rendering using \texttt{WebGL}.
%
Communication between client and server is enabled via the WebSockets protocol.
%
Since our clustering algorithms are written in \texttt{MatLab}\footnote{Owned by The MathWorks, \url{http://mathworks.com}}, we had to access them using the \texttt{NodeJS} server.
%
We accomplished this by converting it to a parameterized standalone console application that is spawned by \texttt{NodeJS} on client request and then reads the result from the console standard out and returns it in a proper format to the client.
%
All parameter-steered console applications can be incorporated in this context.
\\\\
\section{Application}
This section describes how our presented \emph{IVA} workflow is used for an epidemiological use case.
%
We conducted a case study with two domain experts on a data set compiled to analyze lower back pain. 
%
This is one of the most common reasons for an adult to see a physician in the Western civilization \cite{Backpain}.
%
Epidemiological analysis of lumbar back pain, such as the work of Harreby et al. \cite{Harreby1996}, is largely focused on non-image information.
%
In comparable studies, only a few shape-related features are included \cite{Lang2011}.
%
To our knowledge, this is the first approach, where shape-related information of the whole lumbar spine is analyzed along with other epidemiological features.
%
Determining risk factors in this area can lead to \cite{Fletcher2012}:
\begin{itemize}
	\item a better understanding of effects of preventive measures such as occupational health and safety regulations,
	\item prognostic features for diagnosis and treatment of lumbar back pain, and
	\item determination of particularly affected risk groups.
\end{itemize}
%
Characterizing the healthy aging process of the spine is a long-term goal for determining age-normalized probabilities for spine-related diseases by incorporating individual risk factors.
%
\subsection{The Lumbar Spine Data Set}
We divide the data set into image and non-image data.
%
There are 127 features describing diagnosed diseases, lifestyle factors, women-specific factors, pain indicators, laboratory values and somatometric features.
%
The image data was acquired on a 1.5~Tesla scanner (Magnetom Avanto; Siemens Medical Solutions, Erlangen, Germany) by four trained technicians in a standardized way.
%
%The spine protocol consisted of a sagittal T1-weighted turbo-spin-echo sequence (676 / 12 [repetition time msec / echo time msec]; 150$^\circ$ flip angle; 500~mm field of view; $1.1\times1.1\times4.0~mm$ voxels) and a sagittal T2-weighted turbo-spin-echo sequence (3760 / 106 [repetition time msec / echo time msec]; 180$^\circ$ flip angle; 500~mm field of view; $1.1\times1.1\times4.0~mm$ voxels) \cite{Hegenscheid2013}.
The spine protocol consisted of sagittal T1- and T2-weighted turbo-spin-echo sequences with rather large slice distance only sufficient for characterizing the lumbar spine \cite{Hegenscheid2013}.

\subsubsection{Data Preprocessing} \label{application:Data Preprocessing}
The data are preprocessed as described in Section~\ref{Data Preprocessing}.
%
\paragraph{Non-Image Data.} 

To ensure a fast and easy data access outside of statistical processors like \texttt{SPSS}, the data was exported to the JSON file format.
%
Each feature is stored as an object containing: 
\begin{itemize}
	\item the data as array of values--categorical data and error codes are stored using IDs,
	\item the data type (continuous, nominal, ordinal, dichotomous),
	\item a detailed description of the feature, and
	\item the data dictionary translating value or error IDs to the actual values.
\end{itemize}
%
% Binning: https://www.researchgate.net/post/What_metric_best_captures_the_information_loss_when_binning_a_large_data-set_into_a_histogram_representation
Continuous variables are discretized to allow for \emph{Cram\'{e}r's V} contingency coefficient assessment.
%
In consultation with the collaborating epidemiologists, we set the number of groups to five, to allow for contingency assessment.

\paragraph{Image Data.} \label{Image-Data}
The lumbar spine was detected in the image data using a hierarchical finite element method by Rak et al. \cite{Rak2013}.
%
This semi-automatic method requires the user to initialize the tetrahedron-based finite element models (FEM) with a click on the L3 vertebra.
%
Two user-defined landmarks on the top and bottom of the L3 vertebra are used to obtain an initial height estimation of the model.
%
It uses a weighted sum of T1- and T2-weighted MR images to detect the lumbar spine shape.
%
The registered models capture resilient information about the shape of the lumbar spine canal as well as the position of the L1-L5 vertebrae \cite{Klemm2013VMV}.
%
Due to incorrect initialization, strongly deformed spines, contrast differences and artifacts, the model was not able to detect lumbar spines for all subjects.
%
We obtained and worked with 983 tetrahedron models of the lumbar spine.
%
For clustering purposes, we extracted the centerline of the lumbar spine canal, which captures information about lordosis and scoliosis (the medical terms for spine curvature \cite{Klemm2013VMV}).

\subsubsection{Shape Visualization and Clustering}
%
The tetrahedron-based detection model described in Section~\ref{application:Data Preprocessing} consists of corresponding grid points for each structure instance.
%
This allows for calculation of shape distance and similarity.
%
This information is used to calculate mean shapes as described in Section~\ref{Interaction- and Visualization Techniques}.

Shape distance is mapped onto color.
%
For dichotomous variables, the color codes distances between mean shapes of the two groups, for variables with more than two manifestations it encodes the distance to the global mean shape of all subjects (see Figure~\ref{fig:hypothesisfree}).
\\\\
Shape-based clustering is carried out via agglomerative hierarchical clustering of the spine canal centerlines (recall Section~\ref{application:Data Preprocessing} and \cite{Klemm2013VMV}).
%
Since the ``correct'' number of clusters in a given group is unknown, an estimate is computed by means of the knee/elbow method \cite{Salvador2004}.
%
The method has proven to produce sound results on a preliminary data set and was able to reproduce textbook knowledge \cite{Klemm2013VMV}.
\subsection{Domain Experts, Setup and Procedure}
%
%Lam et al. divide evaluations of Visual Analysis systems in two categories, 
%
\com{Anmerkung von Steffen einbauen: Evaluierung geht um fachliches Feedback - Wissen über epidemiologie UND rücken und wissen um die Daten - deswegen schwer ganz viele Experten ranzuziehen}
Guided by the work of Lam et al \cite{Lam2012}, we conducted an investigation of \emph{Visual Data Analysis and Reasoning} (VDAR).
%
This approach aims to characterizes the ability of a system to explore data, discover knowledge, generate hypotheses and help formulating decisions.
%
Since it is hard to quantify when these goals are achieved, Lam et al. suggest case studies for the VDAR analysis.

We conducted a qualitative case study with two epidemiological domain experts.
%
Both of them are practicing clinicians with focus on epidemiological research.
%
The first clinician is an specialist in internal medicine and also the leader of the SHIP.
%
One clinician is an radiologist and responsible for the image acquisition of the SHIP and has a deep understanding on the available image data.
%
\paragraph{Setup.} To bypass the large geographical distance between us and the domain experts and to take their busy schedule into account, the case study was done completely web based.
%
Since one major reason for the focus on web technologies, no software needed to be exchanged.
%
A website link was send to the users, which they could open with their browser of choice and start using the tool.
%
To make the user input comprehensible, we observed their monitor via screen sharing.
%
Communication was enabled via webcam supported voice over ip.
%
The total setup time including installing the screen sharing application was about five minutes.
%
Video-recordings of the sessions made it possible to evaluate the sessions later on.
\com{TODO: Name der Screensharing Software mit angeben (Teamviewer)?}
\paragraph{Procedure.}
At first, controlled mouse and keyboard of the clinicians pc and demonstrated the basic functionalities of the system.
%
This included the Heatmap, the correlation view, how to introduce parameter visualization, how the color coding of differences works and the pivot tables.
%
As they understood the concepts, we handed over the mouse and keyboard control and only observed from this point on.
%
The epidemiologists were given two tasks: one hypothesis-free analysis of the data and one starting with an assumption.

% \subsection{Exploratory Analysis of the Lumbar Spine Data Set}
\subsection{Case 1: Hypothesis-free analysis}
Analyzing the data set without prior hypothesis requires a starting point giving an overview over the data first \cite{Shneiderman1996}.
%
With our tool, there are two ways to achieve this.
%
Performing a \emph{local investigation} by clustering all subjects or use the contingency matrix for a \emph{multivariate analysis}.

\paragraph{Analysis 1.}
%
The latter was chosen first by both domain experts.
%
%They pointed out the high potential they see in this visualization, because it allows to look at the data in an unbiased way.
They pointed out the benefits of the possibility to look at all variables in the context of each other.
%
To cite the radiologist, it "illumunates the black box of the data", making it possible to look at the data in an unbiased way.
%
Due to the dense mapping of information in the contingency matrix it was suggested to make this visualization full screen.
%
The radiologist was looking for correlations with shape related features in the data, finding that they correlate strong with each other as well as with leg pain, age, body height and hormone replacement therapy.
%
The internist inspected features which are not derived from the images, such as parameters strongly related with age, such as income, blood fat values or number of born children.
%
This also shows, that even though the visualization may treat every feature equally, the domain experts is more likely interested in features they are familiar with and have personal clinical experience with.
%
%Many correlations observed in this view 

After this initial overview, the expert performed a \emph{multivariate analysis} by introducing features, such as age, waist circumference, weight or lumbar spine centerline curvature as bar charts views into the canvas area and selected subgroups to see how they are distributed and if they could observe unusual behavior in the mean-shapes.
%
+ Cramer test 
\com{Allgemein: Workflow noch einmal grob beschreiben - Overview first, details on demand}
%
\paragraph{Analysis 2.}
\begin{figure}[htb]
 \centering
 %\includegraphics[width=1.5in]{figures/InteractionLoop}
 \includegraphics[width=3.5in]{figures/hypothesisfree}
 \caption{(a) Clustering result of all subjects. The bar chart height indicates the number of subjects in the cluster. The difference to the mean shape is color-coded, whereas blue represents no difference and red a large difference. (b) A pivot table relates cluster results to gender and employment status. Cluster 8 is striking because of the high proportion of women, while cluster 2, 3, 4 contain almost only men.}
 \label{fig:hypothesisfree}
\end{figure}
\com{ToDo: Rewrite}
%
The internist started also with a \emph{multivariate analysis} using the contingency table, but found no associations he was interested in.
%
Therefore, he applied the \emph{local investigation} pattern by a shape grouping step using shape-based clustering via dragging the "All subjects" feature into the canvas area, triggering the shape clustering.
%Shape-based hypothesis-free exploration starts with the \emph{local investigation} pattern by a shape grouping step using shape-based clustering.
%
The results for this step can be seen in Figure~\ref{fig:hypothesisfree} (a).

Cluster 9 represents subjects with average shape.
%
Other shapes differ with respect to size, such as cluster 2, 3, 8, 10 where the last one also represents a more straight spine, which is usual for subjects with larger body size.
%
Cluster 4, 5, 7 contain outliers, characterized by their unusual shape and small number.
%
Cluster 8 has the second largest number of elements and was therefore of special interest.
%
The user opened the contingency pane to performing a \emph{multivariate analysis} by looking at \emph{Cram\'{e}r's V} contingency values of cluster~8.
%
This revealed associations of this group with employment status, gender, body size, age, thyroid nodules and blood fat value.
%
Another \emph{multivariate analysis} using a pivot table set gender and employment status in relation to clustering affiliation\add{.} 
%
\add{It s}hows that cluster~8 contains mostly women and also has a larger unemployment rate (see Figure~\ref{fig:hypothesisfree}), while the overall employment rate of women and men in the data set is almost exactly 50\%.
%
While all observed features seem to be plausible associations related to back pain, the values indicate that cluster~8 contains subjects with chronic back pain radiating to the legs.
%
Metabolic parameters, such as blood fat and blood sugar, are also possibly associated features.
%
The employment status is a feature relating to many different lifestyle factors such as income or nutrition as well as age and might act as confounder.

% TODO: Contingency Matrix or Adjecency Matrix
\com{00.44 Clustering-Ergebnis Weiblich und Arbeitspensum Alter}

\subsection{Case 2: Hypothesis-based analysis}
If the user proposes a hypothesis about a relation between a non-image feature regarding shape, the workflow slightly differs from the hypothesis-free analysis.
%
The starting point follows the \emph{feature investigation} pattern, where a feature of interest is selected by dragging it into the canvas area and viewing the subject's distribution as well as their shape differences.
\paragraph{Analysis 1}
The radiologist performed a \emph{feature investigation} by dragging the age variable into the canvas area, observing that age-bins 36-52 years and 52-68 years are nearly identical to the global mean, while 20-36 years and 68-84 years differ in size.
%
Performing a \emph{multivariate analysis} by selecting only female subjects via the additionally added gender feature it was observed, that distance was closest to subjects of 68-84 years old and largest to 20-36 years old.
%
The expert argued that this is most likely due to the shrinking of the spine with increasing age, making it more similar to the female average spine which is smaller than the global average \com{(00.29)}.
%

\paragraph{Analysis 2.}
Hypothesis: "Back pain is associated with age and therefore there differences in the lumbar spine shape are observable." \com{TODO Image Mosaic Plot Age, Backpain}.
To validate this hypothesis, a \emph{multivariate analysis} was performed by introducing the dichotomous feature "\emph{Did you experience backpain in the last three moth?}" together with the age as mosaic plot by dropping both features on the canvas area.
%
The experts were not able to observe the expected effect in the visualization.
%
Reasons for this are twofold.
%
For one, age influences the lumbar spine shape very heavily, as seen in Fig~\ref{?}, while the differences between subjects with and without back pain are small.
%
The major difference seen in the visualization are therefore presented by the age feature, masking differences via the back pain parameter.

The second explanation is the commonality of back pain in our society.
%
As seen in Fig~\ref{?}, subjects reporting back pain are even the majority, which makes it difficult to extract parameters which reliably describe back pain.
%
A \emph{local investigation} using the contingency table showed a strong association between back pain with gender and body height.
%
Body height was explained to be a confounder for gender, since female subjects smaller on average than male subjects.
%
The analysis solely based on shape only accentuated gender differences, not in back pain.
%This makes it hard to analyze shape related features for this disease
%
A next step would be to use a variable describing the strength of back pain and only analyzing strong back pain!
%

\com{ToDo: Ability to better create sub groups would be useful as well as better segmentation}
%gender, use of pain medications. this would be good for future work, providing a better way to subdivide the data set and construct groups. The presented method is very good to gain an overview

%
%\com{Video 00.29. Analysis of Gender and Age - older subjects are closer to females, younger to males. This is due to shrinking of the spine in the aging process.}
%\com{Backpain three month > age. There are more subjects reporting backpain than those who dont. Since influences heavily the average shape - since most people have back pain, the average shape already is associated with back pain, which makes it difficult to extract parameters which reliably describe back pain. (1.05) The radiologist pointed out that for the mosaic view it would be beneficial to abstract the shape and curvature and categorize it into shapes s, i form. It was also pointed out that in the plot back pain>age, back pain can not be differenciated because the difference is mainly encoded via the age, more variables need to be added (gender, use of pain medications. this would be good for future work, providing a better way to subdivide the data set and construct groups. The presented method is very good to gain an overview).}

\paragraph{Analysis 3}
\com{ToDo: Needs to be rewritten}
\begin{figure}[htb]
 \centering
 %\includegraphics[width=1.5in]{figures/InteractionLoop}
 \includegraphics[width=3.5in]{figures/hypothesisbased}
 \caption{(a) Dichotomous questionnaire answer to ``\emph{Did you experience back pain in the past three months?}''.
 %
 Mean shapes between the groups show no difference.
 %
 (b) Shape-based clustering for all subjects who suffered from back pain yields 6 groups. 
 %
 Note that the difference in subject count is due to the missing shape information for some subjects.
 %
% The total count of subjects in (b) is smaller 
 }
 \label{fig:hypopthesisbased}
\end{figure}
%
In our use case, epidemiologists were interested in the dichotomous questionnaire answer to ``\emph{Did you experience back pain in the past three months?}''.
%
The mean shapes of the resulting visualization show no difference between the two groups (see Figure~\ref{fig:hypopthesisbased} (a)).
%
Either there are no differences or the variance information was lost in the mean shape calculation.
%
Since the focus is on subjects suffering from back pain, the clustering results of these subjects are then drawn into the canvas area, yielding six clusters as seen in Figure~\ref{fig:hypopthesisbased} (b).
%
Cluster 5 stood out for having a so-called \emph{hyperlordosis}, a strong curvature of the lumbar spine associated with back pain.

\emph{Multivariate analysis} using \emph{Cram\'{e}r's V} contingency values highlighted relationships of this cluster with joint degeneration, meat eating habits, preoccupation, back pain, neck or shoulder pain and waist circumference.
%
Since the prior selection only yields subjects that report back pain, the pain indicators specify the pain localization for the subjects.

It is well known that overweight is a risk factor for back pain.
%
While the BMI is a key figure for assessing height and weight of a subject, it does not tell anything about how the weight is distributed in the body.
%
Our epidemiological collaborators were interested in the correlation with waist circumference presented by this group.
%
Our finding follows the recent trends indicating that BMI is not a good measure for assessing the body shape, since healthy weight is dependent on many other measures \cite{Ahima2013}.
%
It indicates that the waist circumference rather than the BMI interacts with unusually shaped spines for subjects with lumbar back pain.
%
The influence of the parameter is now in the focus of further analysis.

\com{00.46 Second: Analysis of Female subjects via clustering, selction of cluster 2, analysis using Body weight and Age. Clustering Result if 1 gives large distance between other subjects. 00.49 How are can the differences be explained?}
\com{00.46 Feedback Body-Size/Body weight. Some features are sparse, suggestion was made to use quantile/quintile, resulting in equally occupied results. This also depends on what the user is intersted in - for clinical use the outliers may be interesting (57.30). (58.30) From perspective of a radiologists, quartile and quintiles make sense when establishing reference values for diseases; clinical relevant parameter, einflussfaktoren oder risikofaktoren zu identifizieren, je nach dem welche hypothese man verwendet.}

% ---------------------------------------------------------------------------------------------------------
\subsection{Further Feedback and Lessons Learned}
\com{ToDo: Noch einmal auf die VDAR Results eingehen}
%\com{ToDo: Lessons Learned der einzelnen Cases - Fokus bei Hypothesenfreier Analyse muss etwa eine gute Übersichtsvisualisierung sein, da es genau das ist was den Epidemiologen hierzu im Moment fehlt}
%
Both domain experts concluded positively over the benefits of the \emph{IVA} approach when analyzing image based cohort study data.
%
One expert emphasized the way the image data is included into information visualizations which comes much more natural to her due to her background in radiology.
%
%Both experts quickly understood the basic concepts of the visualizations and were able to 
%
The domain experts see another great potential in communicating insights efficiently using the presented visualizations \com{(1.08)}.
%
The experts proposed to improve the visual comparison between image data representations by abstracting them into representative land marks, such as centers of the vertebrae and cardinal points of the lumbar spine canal.
%
\paragraph{Multivariate analysis is most important for hypothesis generation.}
Both experts emphasized the potential of the \emph{multivariate analysis} capabilities of the adjacency matrix for getting insight into a large amount of features simultaneously.
%
It is also useful to verify established but still controversial risk factors, such as the metabolic syndrome for coronary heart disease and whether the data set provides even more suitable risk factors \com{(39.32)}.
%
Creating adjacency matrices for sub groups, such as different age bins can help to characterize the aging process by deriving age-specific risk factors.
%
%\paragraph{Hypothesis driven analysis would benefit from more advanced grouping.}
%While the existing brushing and linking techniques already allow the comparison of image data 
\com{(TODO weitere Unterteilung der Variablen und anschließende Anbindung an Statistik Tools)}

\paragraph{Segmenation quality is crucial.}
The radiologist pointed out the unusual strong similarity of the L3 vertebrae throughout the population.
%
The medical explanation is that it represents a angular point of curvature of the lumbar spine.
%
A seconds explanation is the use of the L3 vertebra is initialization point of the lumbar spine model \com{(00.54)}.

The experts also emphasized that associations related to shape strongly depend on the segmentation quality.
%
The lumbar spine model used in this case study captures deformation of the spine canal well, but lacks precise definition in vertebrae height and shape.
%
Since deformation of the spine canal is commonly the last pathological stage of pathological lumbar spine deformation and is preceded by vertebrae deformation, the system would strongly benefit from more precise segmentation results capturing these prior changes.

\paragraph{Usage of different Categorizations depending on expected outcome.}
When categorizing numerical variables into equal groups it is possible to create very sparse categories due to outliers, for example when analyzing body weight.
%
These outliers are of high interest for finding pathological subjects, but not wanted when new parameters describing risk factors are established.
%
The experts therefore suggested two modes of the tool.
%
The outlier mode still creates categories of equal size, producing sparse categories for outliers.
%
Balanced categories are created on the second mode, which uses quartiles or quintiles to set borders between categories.
\paragraph{Web technologies are well suited for rapid feedback.}
The web-based approach for both implementing the prototype as well as getting feedback via voice over ip conference calls worked very well.
%
Since the software does not need to be compiled, small changes can even be made on the fly during a testing session.
%
The large data base associated with image based epidemiological data remains on the server machine and has not to be moved tediously using external hard disks.
%\com{ToDo Fazit über Web-Austausch, das Experten begeistert davon waren und dass es hervorragend funktioniert. Kleine Änderungen können sogar live programmiert werden ohne das etwas neu kompiliert werden muss (hier wäre ein Beispiel nett, z.B. Größe der Schrift irgendwo. Außerdem bringt der Browser viele Funktionen mit, wie z.B. die Suchfunktionen.)}
%She also pointed out the benefits of an automatic categorization of the subjects into shape groups.%$$, which allows for even faster comparison.
%\com{Employ a more abstract visualization of the spine to capture reliable information and enable better comparison between subjects}
%
%Since many large population studies incorporate medical image data this gains importance.
%\com{1.08 It was pointed out that this technique is also good for epidemiological publication because it is often more insigthfull to show these images instead of long tables.}

%\com{Small User Interface Suggestions: Search-Bar for Subjects, making the elements of the contingency matrix selectable; See which Subject is currently selected}
%\com{Enhancement contingency matrix: Display exact value of correlations, also information about distribution. More focus on this}
%\com{Außerdem ein Anwendungsgebiet für die Matrix: Einschätzen metabolisches syndrom, eine Menge von Risikofaktoren die für Koronare Herzkrankheit Marker darstellen und die bereits länger in der Kritik sind. Hier kann getestet werden, ob es hierfür nicht bessere Indikatoren noch geben kann! (39.32)}
%\com{Also mosaic plots can be incorporated for several sub groups to see where the main differences are (for different age groups to characterize age)}
%\com{1.20 More exact segmentations are useful since curvature changes are often the last change happening in a pathological process, after local deformations of the vertebrae}


% ---------------------------------------------------------------------------------------------------------------------------------------
% ---------------------------------------------------------------------------------------------------------------------------------------
% ---------------------------------------------------------------------------------------------------------------------------------------
% \section{Old Application Section}
% %
% This section describes how our presented \emph{IVA} workflow is used for an epidemiological use case.
% %
% We applied the presented set of techniques to a data set compiled to analyze lower back pain. 
% %
% This is one of the most common reasons for an adult to see a physician in the Western civilization \cite{Backpain}.
% %
% Epidemiological analysis of lumbar back pain, such as the work of Harreby et al. \cite{Harreby1996}, is largely focused on non-image information.
% %
% In comparable studies, only a few shape-related features are included \cite{Lang2011}.
% %
% To our knowledge, this is the first approach, where shape-related information of the whole lumbar spine is analyzed along with other epidemiological features.
% %
% Determining risk factors in this area can lead to \cite{Fletcher2012}:
% \begin{itemize}
% 	\item a better understanding of effects of preventive measures such as occupational health and safety regulations,
% 	\item prognostic features for diagnosis and treatment of lumbar back pain, and
% 	\item determination of particularly affected risk groups.
% \end{itemize}
% % Determining risk factors in this area can lead to \cite{Fletcher2012} (evtl. weglassen, Dopplung bei Epidemiological Background?):
% % \begin{itemize}
% % 	\item a better understanding of effects of preventive measures such as occupational health and safety regulations
% % 	\item prognostic features for diagnosis and treatment of lumbar back pain
% % 	\item determination of particularly effected risk groups
% % \end{itemize}
% %
% Characterizing the healthy aging process of the spine is a long-term goal for determining age-normalized probabilities for spine-related diseases by incorporating individual risk factors.
% 
% Data confidentiality and ethical reasons prohibit us from accessing the complete \texttt{SHIP} feature space.
% %
% Our epidemiological collaborators compiled a feature list, which is a tradeoff between complexity and limitations of the responsible ethics committee.
% %
% \subsection{The Lumbar Spine Data Set}
% We divide the data set into image and non-image data.
% %
% There are 127 features describing diagnosed diseases, lifestyle factors, women-specific factors, pain indicators, laboratory values and somatometric features.
% %
% The image data was acquired on a 1.5~Tesla scanner (Magnetom Avanto; Siemens Medical Solutions, Erlangen, Germany) by four trained technicians in a standardized way.
% %
% %The spine protocol consisted of a sagittal T1-weighted turbo-spin-echo sequence (676 / 12 [repetition time msec / echo time msec]; 150$^\circ$ flip angle; 500~mm field of view; $1.1\times1.1\times4.0~mm$ voxels) and a sagittal T2-weighted turbo-spin-echo sequence (3760 / 106 [repetition time msec / echo time msec]; 180$^\circ$ flip angle; 500~mm field of view; $1.1\times1.1\times4.0~mm$ voxels) \cite{Hegenscheid2013}.
% The spine protocol consisted of sagittal T1- and T2-weighted turbo-spin-echo sequences with rather large slice distance only sufficient for characterizing the lumbar spine \cite{Hegenscheid2013}.
% 
% \subsection{Data Preprocessing} \label{application:Data Preprocessing}
% The data are preprocessed as described in Section~\ref{Data Preprocessing}.
% %
% \paragraph{Non-Image Data.} 
% 
% To ensure a fast and easy data access outside of statistical processors like \texttt{SPSS}, the data was exported to the JSON file format.
% %
% Each feature is stored as an object containing: 
% \begin{itemize}
% 	\item the data as array of values--categorical data and error codes are stored using IDs,
% 	\item the data type (continuous, nominal, ordinal, dichotomous),
% 	\item a detailed description of the feature, and
% 	\item the data dictionary translating value or error IDs to the actual values.
% \end{itemize}
% %
% % Binning: https://www.researchgate.net/post/What_metric_best_captures_the_information_loss_when_binning_a_large_data-set_into_a_histogram_representation
% Continuous variables are discretized to allow for \emph{Cram\'{e}r's V} contingency coefficient assessment.
% %
% In consultation with the collaborating epidemiologists, we set the number of groups to five, to allow for contingency assessment.
% 
% \paragraph{Image Data.} \label{Image-Data}
% The lumbar spine was detected in the image data using a hierarchical finite element method by Rak et al. \cite{Rak2013}.
% %
% This semi-automatic method requires the user to initialize the tetrahedron-based finite element models (FEM) with a click on the L3 vertebra.
% %
% Two user-defined landmarks on the top and bottom of the L3 vertebra are used to obtain an initial height estimation of the model.
% %
% It uses a weighted sum of T1- and T2-weighted MR images to detect the lumbar spine shape.
% %
% The registered models capture resilient information about the shape of the lumbar spine canal as well as the position of the L1-L5 vertebrae \cite{Klemm2013VMV}.
% %
% Due to incorrect initialization, strongly deformed spines, contrast differences and artifacts, the model was not able to detect lumbar spines for all subjects.
% %
% We obtained and worked with 983 tetrahedron models of the lumbar spine.
% %
% For clustering purposes, we extracted the centerline of the lumbar spine canal, which captures information about lordosis and scoliosis (the medical terms for spine curvature \cite{Klemm2013VMV}).
% 
% \subsection{Shape Visualization and Clustering}
% %
% The tetrahedron-based detection model described in Section~\ref{application:Data Preprocessing} consists of corresponding grid points for each structure instance.
% %
% This allows for calculation of shape distance and similarity.
% %
% This information is used to calculate mean shapes as described in Section~\ref{Interaction- and Visualization Techniques}.
% 
% Shape distance is mapped onto color.
% %
% For dichotomous variables, the color codes distances between mean shapes of the two groups, for variables with more than two manifestations it encodes the distance to the global mean shape of all subjects (see Figure~\ref{fig:hypothesisfree}).
% \\\\
% Shape-based clustering is carried out via agglomerative hierarchical clustering of the spine canal centerlines (recall Section~\ref{application:Data Preprocessing} and \cite{Klemm2013VMV}).
% %
% Since the ``correct'' number of clusters in a given group is unknown, an estimate is computed by means of the knee/elbow method \cite{Salvador2004}.
% %
% The method has proven to produce sound results on a preliminary data set and was able to reproduce textbook knowledge \cite{Klemm2013VMV}.
% 
% \subsection{Exploratory Analysis of the Lumbar Spine Data Set}
% %
% Expert-guided analysis assessed the suitability of our approach for supporting both hypothesis-free analysis as well as hypothesis generation. 
% %
% The use of \emph{IVA} patterns as presented in Section~\ref{Image Centric Cohort Study Data in Interactive Visual Analysis Context} is denoted accordingly.
% %
% \subsubsection{Hypothesis-Free Analysis} \label{Hypothesis free Analysis}
% \begin{figure}[htb]
%  \centering
%  %\includegraphics[width=1.5in]{figures/InteractionLoop}
%  \includegraphics[width=3.5in]{figures/hypothesisfree}
%  \caption{(a) Clustering result of all subjects. The bar chart height indicates the number of subjects in the cluster. The difference to the mean shape is color-coded, whereas blue represents no difference and red a large difference. (b) A pivot table relates cluster results to gender and employment status. Cluster 8 is striking because of the high proportion of women, while cluster 2, 3, 4 contain almost only men.}
%  \label{fig:hypothesisfree}
% \end{figure}
% %
% Analyzing the data set without prior hypothesis requires a starting point giving an overview over the data first \cite{Shneiderman1996}.
% %
% Shape-based hypothesis-free exploration starts with the \emph{local investigation} pattern by a shape grouping step using shape-based clustering.
% %
% The results for this step can be seen in Figure~\ref{fig:hypothesisfree} (a).
% 
% Cluster 9 represents subjects with average shape.
% %
% Other shapes differ with respect to size, such as cluster 2, 3, 8, 10 where the last one also represents a more straight spine, which is usual for subjects with larger body size.
% %
% Cluster 4, 5, 7 contain outliers, characterized by their unusual shape and small number.
% %
% Cluster 8 has the second largest number of elements and was therefore of special interest.
% %
% Performing a \emph{multivariate analysis} by looking at \emph{Cram\'{e}r's V} contingency values of cluster~8 reveals associations of this group with employment status, gender, body size, age, thyroid nodules and blood fat value.
% %
% Another \emph{multivariate analysis} using a pivot table set gender and employment status in relation to clustering affiliation\add{.} 
% %
% \add{It s}hows that cluster~8 contains mostly women and also has a larger unemployment rate (see Figure~\ref{fig:hypothesisfree}), while the overall employment rate of women and men in the data set is almost exactly 50\%.
% %
% While all observed features seem to be plausible associations related to back pain, the values indicate that cluster~8 contains subjects with chronic back pain radiating to the legs.
% %
% Metabolic parameters, such as blood fat and blood sugar, are also possibly associated features.
% %
% The employment status is a feature relating to many different lifestyle factors such as income or nutrition as well as age and might act as confounder.
% \\\\
% While this approach does not assume any hypothesis, the 127 epidemiological features were selected by domain experts with a wide range on potential influential factors.
% %
% This filtering step based on expert experience rules out possible confounder and useless associations and it is therefore arguable whether this represents a disadvantage \cite{Wiley2008}.
% %It is arguable whether this first filtering step, which is purely based on expert experience, represents a disadvantage, since it rules out many parameters possibly associated with the presented features, but the value of this knowledge would be small \cite{Wiley2008}.
% %
% % While this approach does not assume any hypothesis, the data are met with a selection bias when compiling the list of related features by the domain experts.
% % %
% % It is arguable if this first filtering step, which is purely based on expert experience, is really a disadvantage, since it rules out many parameters which may interact with the presented features but the value of this knowledge would be small \cite{Wiley2008}.
% 
% \subsubsection{Hypothesis-Based Analysis} \label{Hypothesis based Analysis}
% \begin{figure}[htb]
%  \centering
%  %\includegraphics[width=1.5in]{figures/InteractionLoop}
%  \includegraphics[width=3.5in]{figures/hypothesisbased}
%  \caption{(a) Dichotomous questionnaire answer to ``\emph{Did you experience back pain in the past three months?}''.
%  %
%  Mean shapes between the groups show no difference.
%  %
%  (b) Shape-based clustering for all subjects who suffered from back pain yields 6 groups. 
%  %
%  Note that the difference in subject count is due to the missing shape information for some subjects.
%  %
% % The total count of subjects in (b) is smaller 
%  }
%  \label{fig:hypopthesisbased}
% \end{figure}
% %
% If the user proposes a hypothesis about a relation between a non-image feature regarding shape, the workflow slightly differs from the hypothesis-free analysis.
% %
% The starting point follows the \emph{feature investigation} pattern, where a feature of interest is selected by dragging it into the canvas area and viewing the subject's distribution as well as their shape differences.
% %
% In our use case, epidemiologists were interested in the dichotomous questionnaire answer to ``\emph{Did you experience back pain in the past three months?}''.
% %
% The mean shapes of the resulting visualization show no difference between the two groups (see Figure~\ref{fig:hypopthesisbased} (a)).
% %
% Either there are no differences or the variance information was lost in the mean shape calculation.
% %
% Since the focus is on subjects suffering from back pain, the clustering results of these subjects are then drawn into the canvas area, yielding six clusters as seen in Figure~\ref{fig:hypopthesisbased} (b).
% %
% Cluster 5 stood out for having a so-called \emph{hyperlordosis}, a strong curvature of the lumbar spine associated with back pain.
% 
% \emph{Multivariate analysis} using \emph{Cram\'{e}r's V} contingency values highlighted relationships of this cluster with joint degeneration, meat eating habits, preoccupation, back pain, neck or shoulder pain and waist circumference.
% %
% Since the prior selection only yields subjects that report back pain, the pain indicators specify the pain localization for the subjects.
% 
% It is well known that overweight is a risk factor for back pain.
% %
% While the BMI is a key figure for assessing height and weight of a subject, it does not tell anything about how the weight is distributed in the body.
% %
% Our epidemiological collaborators were interested in the correlation with waist circumference presented by this group.
% %
% Our finding follows the recent trends indicating that BMI is not a good measure for assessing the body shape, since healthy weight is dependent on many other measures \cite{Ahima2013}.
% %
% It indicates that the waist circumference rather than the BMI interacts with unusually shaped spines for subjects with lumbar back pain.
% %
% The influence of the parameter is now in the focus of further analysis.
% 
% \subsubsection{Follow-Up Tasks and Concluding Domain-Expert Feedback}
% %
% Correlation does not automatically imply causation. %\cite{Tufte2003}.
% %
% In particular, when large amounts of attributes are automatically checked for strong correlations, just by chance hundreds of them reach at least a moderately significant correlation, such as $p>0.05$.
% %Defining a causal relationship solely based on observed correlations of two features is \emph{cum hoc ergo propter hoc}--correlation does not automatically imply causation \cite{Tufte2003}.
% %
% The observed correlations need to be carefully checked for confounders and medical soundness.
% %
% Statisticians validate causal inferences of the drawn conclusions.
% 
% Features that potentially interact with a disease-related condition need to be validated.
% %
% To increase the probability of the observation not to be random and to avoid \emph{overfitting}, they are cross-checked for associations in \texttt{SHIP-TREND} as a second, independent population sample, which was examined with methods identical to \texttt{SHIP}.
% \\\\
% The prototype was demonstrated to the domain experts (with background on epidemiology and radiology) via screen sharing.
% %
% The software was operated by a computer scientist following instructions of the domain experts.
% %
% The presented methods guide the attention to features that are not in the focus of attention and expectance of clinical researchers.
% %
% The explorative nature of the methods work well for gathering associations possibly acting as confounder, as outcome of a disease or as an actual cause or risk factor.
% %"\emph{Correlation does not imply causation}" is a famous saying in statistics, meaning that correlation does not necessarily imply causal relationships \cite{}.
% %
% This distinction is hard to make and requires a lot of clinical experience.
% %
% The combination of multiple views with shape information helps to connect many different information sources to make the large information spaces cognitively feasible.
% %
% Displaying MRI scans for the subjects in the outlier cluster is promising because they are highly likely to exhibit pathologies.
% %
% %We plan to include a \texttt{DICOM}-viewer to meet this wish.
% 
% % - Describe steps from gathering Information from the raw image files (segmentation, abstraction, visualization)\\
% % - Problem of sparse differences - Visualization has to be more abstract to emphasize the differences.\\
% % - Input of Epidemiologists goes here!\\
% ---------------------------------------------------------------------------------------------------------------------------------------
% ---------------------------------------------------------------------------------------------------------------------------------------
% ---------------------------------------------------------------------------------------------------------------------------------------

\section{Summary and Conclusion}
% TODO: Future work Bulletliste zusammenkürzen
In this paper, we presented an \emph{IVA} framework for the analysis of complex image-centric epidemiological data.
%
Hence, the framework allows for both, hypothesis-driven analysis and hypothesis generation.
%
The visualization of multivariate data using connected views and different views allows to get fast visual feedback about subject groups.
%
Brushing and linking makes the data tangible and adaptable to formulated hypotheses.
%
The use of pivot tables is familiar to epidemiologists while embracing the power of interactive adjustment of the shown features.
%
The automatic suggestion of correlations using contingency methods like \emph{Cram\'{e}r's V} triggers \emph{hypothesis generation} by highlighting features potentially overlooked by the experts.
%
Shape-based clustering assesses the variability of a anatomical structure in the context of non-image features such as disease indicators or lifestyle factors.

Our clinical partners from the \texttt{SHIP} are for the first time able to assess shape information of the lumbar spine and its influence to diseases.
%
Findings from analyzing lumbar back pain using the \emph{IVA} approach range from deriving shape-based groups of subjects to detailed description of features potentially associated with the disease, such as waist circumference, thyroid nodules and blood fat values.
%
Other somatometric features, such as BMI, are not as influential as expected.
%
\\\\\
A number of improvements is left open for future work, e.g.,

\begin{itemize}
%	\item dynamic discretization of continuous variables to better fit the data distributions
	\item shape brushing methods to intuitively query subjects using image data,
	\item the inclusion of more statistical methods and views that are familiar to the epidemiologists (odds ratios, box plots), or
	%\item calculation of contingency differences for selected sub groups--highlighting how the feature correlation changes for a given group
	%\item integration of further visualization techniques, which incorporate both image and non-image data
	%\item support of control groups to check the resilience of observations \cite{Fletcher2012}.
%	\item understand how the existing methods are applied to the data, iteratively adapt to the epidemiologiical workflow
%	\item investigate which parts of the methods are applied by domain experts and what aspecunderstand how the existing methods are applied to the data, iteratively adapt to the epidemiologiical workflow
	\item adapt the shape visualization to explore other organ data with different variance type (such as texture of liver or white/gray matter distribution in the brain).
\end{itemize}
% These benefits 
% - Future Work: Matrix-View of differences - more intuitive\\
% - UI more flexible by hiding UI-panes
% - More Shape-based filtering - reorder by size, curvature, etc. ...
% - Color code different Aspects - Only difference in x or y direction
% - Adjacency Matrix is symmetrical, space can be saved
% - Calculation of contingency based on the contingency differences - how does the current selection differ compared to the whole data set?
%
% To reduce the number of false positive findings, the data space can also be randomly cut in half.
% %
% Then the hypothesis then can be cross-validated for statistical soundness.
% %
% This requires a large number of subjects, especially if the investigated features are rare and only presented by a few subjects.
%
%As suggested by Fletcher and Fletcher, we plan to validate the hypothesis using the \texttt{SHIP-TREND} cohort \cite{Fletcher2012}.
% \\\\
As the number of image-centric cohort studies, participating subjects, gathered features and imaging modalities rises, and advances towards comparability between cohort studies are made, the gap between data complexity and analyzability increases.
%
Our work focuses on closing this gap, allowing the domain experts to dig deep into the data and potentially obtain unexpected findings.
%
We believe that web technologies pave the way to analyze this data in a convenient way.
%
They allow a fast exchange between users and developers and employ many different devices.
%
Visual analysis shows to be a promising way to clear the view on complex epidemiological data to uncover its secrets.

%% if specified like this the section will be committed in review mode
\acknowledgments{SHIP is part of the Community Medicine Research net of the University of Greifswald, Germany, which is funded by the Federal Ministry of Education and Research (grant no. 03ZIK012), the Ministry of Cultural Affairs as well as the Social Ministry of the Federal State of Mecklenburg-West Pomerania. Whole-body MR imaging was supported by a joint grant from Siemens Healthcare, Erlangen, Germany and the Federal State of Mecklenburg-Vorpommern. The University of Greifswald is a member of the ‘Centre of Knowledge Interchange’ program of the Siemens AG. This work was supported by the DFG Priority Program 1335: Scalable Visual Analytics.}
\clearpage
\newpage
\bibliographystyle{abbrv}
%%use following if all content of bibtex file should be shown
%\nocite{*}
\bibliography{bibliography}
\end{document}
